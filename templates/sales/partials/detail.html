
<div class="container mt-4">
  <!-- Breadcrumb Navigation -->
  <nav aria-label="breadcrumb">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{% url 'sales:sales_invoice_list' %}">Invoice Listing</a></li>
      <li class="breadcrumb-item active" aria-current="page">Sales Detail</li>
    </ol>
  </nav>

  <!-- Page Header -->
  <div class="row mb-4">
    <div class="col">
      <h1 class="display-4">Sales Detail</h1>
    </div>
  </div>

   <!-- Action Buttons -->
   <p>
    <a class="btn btn-primary" href="{% url 'sales:sales_invoice_list' %}">Sale Listing</a>
    <a class="btn btn-secondary" href="">Print</a>
    <a class="btn btn-primary" href="{% url 'sales:sales_invoice_update' object.id%}">Edit</a>
    <a class="btn btn-danger" href="{% url 'sales:sales_invoice_delete' object.id %}">Delete</a>
    <a class="btn btn-primary" href="{% url 'sales:sales_invoice_create' %}">Add Sale</a>
  </p>

  <!-- Navigation Buttons -->
  <div class="btn-group justify-content-between" role="group" aria-label="Basic example">
    {% if previous %}
    <a href="{% url 'sales:sales_invoice_detail' previous.pk %}" type="button" class="btn btn-primary mr-2">Previous {{previous.id}}</a>
    {% endif %}
    {% if next %}
    <a href="{% url 'sales:sales_invoice_detail' next.id %}" type="button" class="btn btn-primary mr-2">Next {{next.id}}</a>
    {% endif %}
  </div>
 
  <div class="row mt-4">
    <!-- Sales Details Card -->
        <div class="col-md-4 mb-4">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">Sales Details</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-12">
              <ul class="list-group list-group-flush">
                <li class="list-group-item bg-primary text-white">
                  <strong>ID:</strong> <span>{{object.id}}</span>
                </li>
                <li class="list-group-item bg-primary text-white">
                  <strong>Customer:</strong> <span>{{object.customer}}</span>
                </li>
                <li class="list-group-item bg-primary text-white">
                  <strong>Created:</strong> <span>{{object.created}}</span>
                </li>
                <li class="list-group-item bg-primary text-white">
                  <strong>Updated:</strong> <span>{{object.updated}}</span>
                </li>
                <li class="list-group-item bg-primary text-white">
                  <strong>Status:</strong> <span>{{object.status}}</span>
                </li>
              </ul>
            </div>
            <div class="col-md-12 mt-3">
              <h6 class="card-subtitle mb-2">Weights and Rates</h6>
              <ul class="list-group list-group-flush">
                <li class="list-group-item bg-primary text-white">
                  <strong>Gross Wt:</strong> <span>{{object.get_gross_wt}}</span>
                </li>
                <li class="list-group-item bg-primary text-white">
                  <strong>Net Wt:</strong> <span>{{object.get_net_wt}}</span>
                </li>
                <li class="list-group-item bg-primary text-white">
                  <strong>Is Ratecut:</strong> <span>{{object.is_ratecut}}</span>
                </li>
                <li class="list-group-item bg-primary text-white">
                  <strong>GST:</strong> <span>{{object.is_gst}}</span>
                </li>
                <li class="list-group-item bg-primary text-white">
                  <strong>Balance:</strong> <span>{{object.get_balance}}</span>
                </li>
                <li class="list-group-item bg-primary text-white">
                  <strong>Paid:</strong> <span>{{object.get_allocations}}</span>
                </li>
              </ul>
              <div class="form-check form-switch mt-3">
                <input class="form-check-input" type="checkbox" role="switch" id="ratecutSwitch"
                  {% if object.is_ratecut %} checked {% endif %}
                  hx-post="{% url 'sales:sales_ratecut_change' object.id%}">
                <label class="form-check-label" for="ratecutSwitch">Ratecut</label>
              </div>
              <div class="form-check form-switch mt-2">
                <input class="form-check-input" type="checkbox" role="switch" id="gstSwitch"
                  {% if object.is_gst %} checked {% endif %}
                  hx-post="{% url 'sales:sales_gst_change' object.id%}">
                <label class="form-check-label" for="gstSwitch">GST</label>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tabs -->
    <div class="col-md-8">
      <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="sales-items-tab" data-bs-toggle="tab" data-bs-target="#sales-items" type="button" role="tab" aria-controls="sales-items" aria-selected="true">
            Sales Items
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="receipts-tab" data-bs-toggle="tab" data-bs-target="#receipts" type="button" role="tab" aria-controls="receipts" aria-selected="false">
            Receipts
          </button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="journals-tab" data-bs-toggle="tab" data-bs-target="#journals" type="button" role="tab" aria-controls="journals" aria-selected="false">
            Transactions
          </button>
        </li>
      </ul>

      <div class="tab-content" id="myTabContent">
        <!-- Sales Items Tab -->
        <div class="tab-pane fade show active" id="sales-items" role="tabpanel" aria-labelledby="sales-items-tab">
          <div class="card mt-3">
            <div class="card-body table-responsive">
              <a hx-get="{% url 'sales:sales_invoiceitem_create' object.id%}" hx-target="#items" hx-swap="beforeend" class="btn btn-primary mb-3">
                Add Items
              </a>
              <table class="table table-striped table-sm">
                <thead>
                  <tr>
                    <th>Return</th><th>Product</th><th>Qty</th><th>Weight</th><th>Touch</th><th>Nett</th><th>Charges</th><th>Total</th>
                  </tr>
                </thead>
                <tbody id="items" hx-target="closest tr" hx-swap="outerHTML">
                  {% for item in object.get_invoiceitem_children %}
                  {% include 'sales/partials/item-inline.html' with object=item %}
                  {% endfor %}
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Receipts Tab -->
        <div class="tab-pane fade" id="receipts" role="tabpanel" aria-labelledby="receipts-tab">
          <div class="card mt-3">
            <div class="card-body table-responsive">
              {% if object.receiptallocation_set %}
              <table class="table table-sm table-striped table-bordered">
                <thead class="thead-dark">
                  <tr>
                    <th>Receipt</th><th>Created</th><th>Amount</th>
                  </tr>
                </thead>
                <tbody>
                  {% for i in object.receiptallocation_set.all %}
                  <tr>
                    <td><a href="{% url 'sales:sales_receipt_detail' i.receipt.id %}">{{i.receipt.id}}</a></td>
                    <td>{{i.created}}</td>
                    <td>{{i.allocated_amount}}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
              {% endif %}
            </div>
          </div>
        </div>

        <!-- Journals Tab -->
        <div class="tab-pane fade" id="journals" role="tabpanel" aria-labelledby="journals-tab">
          {% include 'dea/txns.html' with object=je%}
        </div>
      </div>
    </div>
  </div>
</div>


    